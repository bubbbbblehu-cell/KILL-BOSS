# æ¨¡å—åŒ–ä»£ç ç»“æ„è¯´æ˜

## ğŸ“ ç›®å½•ç»“æ„

```
KILL-BOSS/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”œâ”€â”€ main.js          # ä¸»å…¥å£æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ app.js           # åº”ç”¨åˆå§‹åŒ–
â”‚   â”‚   â”œâ”€â”€ config.js        # é…ç½®å¸¸é‡
â”‚   â”‚   â”œâ”€â”€ state.js         # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ supabase.js      # Supabase å®¢æˆ·ç«¯ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ auth.js          # è®¤è¯åŠŸèƒ½
â”‚   â”‚   â”œâ”€â”€ navigation.js   # é¡µé¢å¯¼èˆª
â”‚   â”‚   â”œâ”€â”€ utils.js         # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ diagnostics.js   # è¯Šæ–­å·¥å…·
â”‚   â””â”€â”€ server.js            # åç«¯æœåŠ¡å™¨ï¼ˆå¦‚æœä½¿ç”¨ï¼‰
â”œâ”€â”€ index.html               # ä¸» HTML æ–‡ä»¶
â”œâ”€â”€ style.css               # æ ·å¼æ–‡ä»¶
â””â”€â”€ main.js                 # æ—§æ–‡ä»¶ï¼ˆå·²åºŸå¼ƒï¼Œå¯åˆ é™¤ï¼‰
```

## ğŸ“¦ æ¨¡å—è¯´æ˜

### 1. `config.js` - é…ç½®æ¨¡å—
**èŒè´£**ï¼šå­˜å‚¨æ‰€æœ‰é…ç½®å¸¸é‡å’Œè®¾ç½®
- Supabase é…ç½®ï¼ˆURLã€API Keyã€ç‰ˆæœ¬ï¼‰
- æ¿€åŠ±æ–‡å­—åº“
- åº”ç”¨é»˜è®¤é…ç½®

**å¯¼å‡º**ï¼š
- `SUPABASE_CONFIG` - Supabase é…ç½®å¯¹è±¡
- `MOTIVATIONAL_QUOTES` - æ¿€åŠ±æ–‡å­—æ•°ç»„
- `APP_CONFIG` - åº”ç”¨é»˜è®¤é…ç½®

### 2. `state.js` - çŠ¶æ€ç®¡ç†æ¨¡å—
**èŒè´£**ï¼šç®¡ç†å…¨å±€åº”ç”¨çŠ¶æ€
- ç”¨æˆ·ç™»å½•çŠ¶æ€
- ç”¨æˆ·ä¿¡æ¯
- åº”ç”¨æ•°æ®ï¼ˆç§¯åˆ†ã€ä¾¿ä¾¿æ•°ç­‰ï¼‰

**å¯¼å‡º**ï¼š
- `appState` - å…¨å±€çŠ¶æ€å¯¹è±¡
- `updateUser()` - æ›´æ–°ç”¨æˆ·ä¿¡æ¯
- `clearUser()` - æ¸…é™¤ç”¨æˆ·ä¿¡æ¯
- `setGuestMode()` - è®¾ç½®æ¸¸å®¢æ¨¡å¼
- `getCurrentUser()` - è·å–å½“å‰ç”¨æˆ·
- `isAuthenticated()` - æ£€æŸ¥æ˜¯å¦å·²ç™»å½•

### 3. `supabase.js` - Supabase å®¢æˆ·ç«¯ç®¡ç†
**èŒè´£**ï¼šSupabase å®¢æˆ·ç«¯çš„åˆå§‹åŒ–å’Œç®¡ç†
- å®¢æˆ·ç«¯åˆå§‹åŒ–
- åŠ¨æ€åŠ è½½ Supabase åº“
- ä¼šè¯ç®¡ç†

**å¯¼å‡º**ï¼š
- `initSupabase()` - åˆå§‹åŒ–å®¢æˆ·ç«¯
- `loadSupabaseAndInit()` - åŠ¨æ€åŠ è½½å¹¶åˆå§‹åŒ–
- `getSupabaseClient()` - è·å–å®¢æˆ·ç«¯å®ä¾‹
- `checkAndRestoreSession()` - æ£€æŸ¥å¹¶æ¢å¤ä¼šè¯

### 4. `auth.js` - è®¤è¯æ¨¡å—
**èŒè´£**ï¼šå¤„ç†ç”¨æˆ·è®¤è¯ç›¸å…³åŠŸèƒ½
- ç”¨æˆ·ç™»å½•
- ç”¨æˆ·æ³¨å†Œ
- ç”¨æˆ·ç™»å‡º
- æ¸¸å®¢ç™»å½•

**å¯¼å‡º**ï¼š
- `handleLogin()` - ç™»å½•å‡½æ•°
- `handleRegister()` - æ³¨å†Œå‡½æ•°
- `handleGuestLogin()` - æ¸¸å®¢ç™»å½•
- `handleLogout()` - ç™»å‡ºå‡½æ•°

**å…¨å±€å‡½æ•°**ï¼ˆæŒ‚è½½åˆ° windowï¼‰ï¼š
- `window.handleLogin` - HTML è°ƒç”¨
- `window.handleRegister` - HTML è°ƒç”¨
- `window.handleGuestLogin` - HTML è°ƒç”¨
- `window.handleLogout` - HTML è°ƒç”¨

### 5. `navigation.js` - é¡µé¢å¯¼èˆªæ¨¡å—
**èŒè´£**ï¼šå¤„ç†é¡µé¢åˆ‡æ¢å’Œå¯¼èˆª
- é¡µé¢åˆ‡æ¢
- æ¼”ç¤ºåŠ¨ç”»æ§åˆ¶

**å¯¼å‡º**ï¼š
- `switchPage()` - åˆ‡æ¢é¡µé¢
- `skipDemo()` - è·³è¿‡æ¼”ç¤º

**å…¨å±€å‡½æ•°**ï¼ˆæŒ‚è½½åˆ° windowï¼‰ï¼š
- `window.switchPage` - HTML è°ƒç”¨
- `window.skipDemo` - HTML è°ƒç”¨

### 6. `utils.js` - å·¥å…·å‡½æ•°æ¨¡å—
**èŒè´£**ï¼šæä¾›å„ç§è¾…åŠ©å‡½æ•°
- UI è¾…åŠ©å‡½æ•°
- é€šç”¨å·¥å…·å‡½æ•°

**å¯¼å‡º**ï¼š
- `startLoginDemo()` - å¯åŠ¨ç™»å½•æ¼”ç¤ºåŠ¨ç”»

### 7. `diagnostics.js` - è¯Šæ–­å·¥å…·æ¨¡å—
**èŒè´£**ï¼šæä¾›è°ƒè¯•å’Œè¯Šæ–­åŠŸèƒ½
- Supabase è¿æ¥è¯Šæ–­
- é…ç½®æ£€æŸ¥

**å¯¼å‡º**ï¼š
- `diagnoseSupabase()` - Supabase è¯Šæ–­å‡½æ•°

**å…¨å±€å‡½æ•°**ï¼ˆæŒ‚è½½åˆ° windowï¼‰ï¼š
- `window.diagnoseSupabase` - æ§åˆ¶å°è°ƒç”¨

### 8. `app.js` - åº”ç”¨åˆå§‹åŒ–æ¨¡å—
**èŒè´£**ï¼šåº”ç”¨å¯åŠ¨å’Œåˆå§‹åŒ–
- åˆå§‹åŒ– Supabase
- æ¢å¤ç™»å½•çŠ¶æ€
- æµ‹è¯•æ•°æ®åº“è¿æ¥

**å¯¼å‡º**ï¼š
- `initApp()` - åˆå§‹åŒ–åº”ç”¨å‡½æ•°

**è‡ªåŠ¨æ‰§è¡Œ**ï¼šåœ¨ `DOMContentLoaded` äº‹ä»¶æ—¶è‡ªåŠ¨è°ƒç”¨

### 9. `main.js` - ä¸»å…¥å£æ–‡ä»¶
**èŒè´£**ï¼šå¯¼å…¥æ‰€æœ‰æ¨¡å—
- ç»Ÿä¸€å¯¼å…¥æ‰€æœ‰æ¨¡å—
- ç¡®ä¿æ¨¡å—åŠ è½½é¡ºåº

## ğŸ”„ æ¨¡å—ä¾èµ–å…³ç³»

```
main.js
  â”œâ”€â”€ config.js (æ— ä¾èµ–)
  â”œâ”€â”€ state.js (ä¾èµ– config.js)
  â”œâ”€â”€ supabase.js (ä¾èµ– config.js)
  â”œâ”€â”€ auth.js (ä¾èµ– supabase.js, state.js, utils.js, navigation.js)
  â”œâ”€â”€ navigation.js (æ— ä¾èµ–)
  â”œâ”€â”€ utils.js (æ— ä¾èµ–)
  â”œâ”€â”€ diagnostics.js (ä¾èµ– config.js)
  â””â”€â”€ app.js (ä¾èµ– supabase.js, state.js, navigation.js, config.js)
```

## ğŸ“ ä½¿ç”¨æ–¹å¼

### åœ¨ HTML ä¸­å¼•å…¥

```html
<!-- Supabase åº“ï¼ˆå¿…é¡»åœ¨æ¨¡å—ä¹‹å‰åŠ è½½ï¼‰ -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.0"></script>

<!-- æ¨¡å—åŒ– JavaScriptï¼ˆä½¿ç”¨ type="module"ï¼‰ -->
<script type="module" src="src/js/main.js"></script>
```

### åœ¨ä»£ç ä¸­ä½¿ç”¨æ¨¡å—

```javascript
// å¯¼å…¥æ¨¡å—
import { appState, updateUser } from './state.js';
import { getSupabaseClient } from './supabase.js';
import { handleLogin } from './auth.js';

// ä½¿ç”¨æ¨¡å—
const client = getSupabaseClient();
await handleLogin(email, password);
```

## âœ… ä¼˜åŠ¿

1. **ä»£ç ç»„ç»‡æ¸…æ™°**ï¼šæ¯ä¸ªæ¨¡å—èŒè´£å•ä¸€ï¼Œæ˜“äºç†è§£
2. **æ˜“äºç»´æŠ¤**ï¼šä¿®æ”¹æŸä¸ªåŠŸèƒ½åªéœ€ç¼–è¾‘å¯¹åº”æ¨¡å—
3. **å¯å¤ç”¨æ€§**ï¼šæ¨¡å—å¯ä»¥åœ¨å…¶ä»–åœ°æ–¹å¤ç”¨
4. **æ˜“äºæµ‹è¯•**ï¼šæ¯ä¸ªæ¨¡å—å¯ä»¥ç‹¬ç«‹æµ‹è¯•
5. **å›¢é˜Ÿåä½œ**ï¼šä¸åŒå¼€å‘è€…å¯ä»¥åŒæ—¶å·¥ä½œåœ¨ä¸åŒæ¨¡å—
6. **ä»£ç å¤ç”¨**ï¼šé¿å…é‡å¤ä»£ç 

## ğŸ”§ è¿ç§»è¯´æ˜

### æ—§ä»£ç ä½ç½® â†’ æ–°æ¨¡å—ä½ç½®

- å…¨å±€çŠ¶æ€ (`appState`) â†’ `src/js/state.js`
- Supabase é…ç½® â†’ `src/js/config.js`
- Supabase åˆå§‹åŒ– â†’ `src/js/supabase.js`
- ç™»å½•/æ³¨å†ŒåŠŸèƒ½ â†’ `src/js/auth.js`
- é¡µé¢å¯¼èˆª â†’ `src/js/navigation.js`
- å·¥å…·å‡½æ•° â†’ `src/js/utils.js`
- è¯Šæ–­åŠŸèƒ½ â†’ `src/js/diagnostics.js`
- åº”ç”¨åˆå§‹åŒ– â†’ `src/js/app.js`

### åˆ é™¤æ—§æ–‡ä»¶

å¯ä»¥å®‰å…¨åˆ é™¤æ ¹ç›®å½•ä¸‹çš„ `main.js` æ–‡ä»¶ï¼ˆå·²è¿ç§»åˆ° `src/js/main.js`ï¼‰

## ğŸš€ åç»­æ‰©å±•

æ·»åŠ æ–°åŠŸèƒ½æ—¶ï¼Œå¯ä»¥ï¼š
1. åˆ›å»ºæ–°çš„æ¨¡å—æ–‡ä»¶ï¼ˆå¦‚ `src/js/posts.js` å¤„ç†å¸–å­åŠŸèƒ½ï¼‰
2. åœ¨ `main.js` ä¸­å¯¼å…¥æ–°æ¨¡å—
3. åœ¨å¯¹åº”æ¨¡å—ä¸­å®ç°åŠŸèƒ½

è¿™æ ·ä¿æŒä»£ç ç»“æ„æ¸…æ™°ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•ã€‚
