# 更新日志

## v2.0 - 2026-02-09

### 🎉 重大更新：邮箱验证码登录

#### 新增功能
- ✅ **邮箱验证码登录**：替代原有的密码登录方式
- ✅ **邮箱验证码注册**：新用户通过验证码即可注册并登录
- ✅ **统一认证流程**：登录和注册使用相同的验证码机制
- ✅ **验证码倒计时**：60秒倒计时，防止频繁发送
- ✅ **邮箱自动补全**：支持常用邮箱后缀自动提示

#### 移除功能
- ❌ 密码登录方式
- ❌ 密码注册方式
- ❌ 密码显示/隐藏切换
- ❌ 确认密码输入框

#### 技术改进
- 使用 Supabase OTP (One-Time Password) 认证
- 简化了用户注册流程
- 提升了账号安全性
- 优化了用户体验

#### 文件变更
1. **src/js/auth.js**
   - 新增 `sendLoginCode()` - 发送登录验证码
   - 新增 `sendRegisterCode()` - 发送注册验证码
   - 修改 `handleLogin()` - 使用验证码登录
   - 修改 `handleRegister()` - 使用验证码注册
   - 修改 `handleLogout()` - 适配新的表单结构
   - 优化 `startCodeCountdown()` - 统一倒计时逻辑
   - 移除密码相关函数

2. **index.html**
   - 登录表单：移除密码输入框，添加验证码输入框
   - 注册表单：移除密码和确认密码输入框，添加验证码输入框
   - 添加"发送验证码"按钮
   - 优化表单布局和交互

3. **style.css**
   - 添加 `.form-hint` 样式 - 验证码提示文字
   - 保留邮箱自动补全样式

4. **新增文档**
   - `EMAIL_OTP_LOGIN_GUIDE.md` - 邮箱验证码登录使用指南

#### 使用说明

**登录流程：**
1. 输入邮箱地址
2. 点击"发送验证码"
3. 查收邮件，输入6位验证码
4. 点击"登录"

**注册流程：**
1. 点击"没有账号？去注册"
2. 输入邮箱地址
3. 点击"发送验证码"
4. 输入验证码，点击"验证并登录"
5. 系统自动创建账号并登录

#### 注意事项
- 验证码有效期为60秒
- 发送验证码有频率限制（60秒内只能发送一次）
- 需要稳定的网络连接
- 国内用户可能需要科学上网

#### 兼容性
- 完全兼容现有的 Supabase 认证系统
- 游客模式保持不变
- 用户数据结构无变化

---

## v1.0 - 之前版本

### 功能
- 密码登录
- 密码注册
- 游客模式
- 基础功能（滑一滑、地图、画画、个人中心）

